<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><title>Oracle多表查询 | MAKER BLOG</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="author" content="Ma"><meta name="designer" content="minfive"><meta name="keywords" content="maker,maker blog,java,javaweb,servlet,jsp,mysql,oracle,Spring,hibernate,struts2,算法，数据结构"><meta name="description" content="个人学习笔记分享"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=yes"><meta name="mobile-web-app-capable" content="yes"><meta name="robots" content="all"><link rel="canonical" href="http://yoursite.com/2018/03/14/Oracle基本命令04/index.html"><link rel="icon" type="image/png" href="/img/favicon.ico" sizes="32x32"><link rel="stylesheet" href="/scss/base/index.css"><link rel="alternate" href="/atom.xml" title="Maker"><link rel="stylesheet" href="/scss/views/page/post.css"></head><body ontouchstart><div id="page-loading" class="page page-loading" style="background-image:url(/img/loader.gif)"></div><div id="page" class="page js-hidden"><header class="page__small-header page__header--small"><nav class="page__navbar"><div class="page__container navbar-container"><a class="page__logo" href="/" title="Maker" alt="Maker"><img src="/img/logo.gif" alt="Maker"></a><nav class="page__nav"><ul class="nav__list clearfix"><li class="nav__item"><a href="/" alt="首页" title="首页">首页</a></li><li class="nav__item"><a href="/archives" alt="归档" title="归档">归档</a></li><li class="nav__item"><a href="/demo" alt="作品" title="作品">作品</a></li><li class="nav__item"><a href="/about" alt="关于" title="关于">关于</a></li></ul></nav><button class="page__menu-btn" type="button"><i class="iconfont icon-menu"></i></button></div></nav></header><main class="page__container page__main"><div class="page__content"><article class="page__post"><div class="post__cover"><img src="/img/oracle.gif" alt="Oracle多表查询"></div><header class="post__info"><h1 class="post__title">Oracle多表查询</h1><div class="post__mark"><div class="mark__block"><i class="mark__icon iconfont icon-write"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="https://www.github.com/Mabintao">Ma</a></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-time"></i><ul class="mark__list clearfix"><li class="mark__item"><span>2018-03-14</span></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-tab"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="/tags/数据库/">数据库</a></li><li class="mark__item"><a href="/tags/Oracle/">Oracle</a></li><li class="mark__item"><a href="/tags/SQL/">SQL</a></li></ul></div></div></header><div class="post__content"><p>通过连接可以建立多表查询，多表查询的数据可以来自多个表，但是表之间<strong>必须</strong>有适当的连接条件。为了从多张表中查询，必须识别连接多张表的公共列。一般是在WHERE子句中用比较运算符指明连接的条件。</p><p>忘记说明表的连接条件是常见的一种错误，这时查询将会产生表连接的笛卡尔积(即一个表中的每条记录与另一个表中的每条记录作连接产生的结果)。一般N个表进行连接，需要至少<strong>N-1</strong>个连接条件，才能够正确连接。两个表连接是最常见的情况，只需要说明一个连接条件。</p><h2 id="连接类型"><a href="#连接类型" class="headerlink" title="连接类型"></a>连接类型</h2><ul><li>等值连接</li><li>非等值连接</li><li>左外连接</li><li>右外连接</li><li>自链接</li><li>层次连接</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--等值连接</span></span><br><span class="line"><span class="comment">--查询员工信息：员工号  姓名 月薪 部门名称</span></span><br><span class="line"><span class="keyword">select</span> e.empno,e.ename,e.sal,d.dname  <span class="keyword">from</span> emp e,dept d <span class="keyword">where</span> e.deptno=d.deptno;</span><br><span class="line">     EMPNO ENAME             SAL DNAME </span><br><span class="line"><span class="comment">---------- ---------- ---------- --------------     </span></span><br><span class="line">      7369 SMITH             800 RESEARCH         </span><br><span class="line">      7499 ALLEN            1600 SALES              </span><br><span class="line">      7521 WARD             1250 SALES                         </span><br><span class="line">      7566 JONES            2975 RESEARCH      </span><br><span class="line">      7654 MARTIN           1250 SALES     </span><br><span class="line"></span><br><span class="line"><span class="comment">--不等值连接</span></span><br><span class="line"><span class="comment">--查询员工信息：员工号  姓名 月薪 工资级别</span></span><br><span class="line"><span class="keyword">select</span> e.empno,e.ename,e.sal,s.grade <span class="keyword">from</span> emp e,salgrade s</span><br><span class="line"><span class="keyword">where</span> e.sal <span class="keyword">between</span> s.losal  <span class="keyword">and</span> s.hisal;</span><br><span class="line">     EMPNO ENAME             SAL      GRADE                                     </span><br><span class="line"><span class="comment">---------- ---------- ---------- ----------                                     </span></span><br><span class="line">      7369 SMITH             800          1                                     </span><br><span class="line">      7900 JAMES             950          1                                     </span><br><span class="line">      7876 ADAMS            1100          1                                     </span><br><span class="line">      7521 WARD             1250          2                                     </span><br><span class="line">      7654 MARTIN           1250          2                                     </span><br><span class="line">      7934 MILLER           1300          2                                     </span><br><span class="line">      7844 TURNER           1500          3                                     </span><br><span class="line">      7499 ALLEN            1600          3                                     </span><br><span class="line">      7782 CLARK            2450          4                                     </span><br><span class="line">      7698 BLAKE            2850          4                                     </span><br><span class="line">      7566 JONES            2975          4    </span><br><span class="line"></span><br><span class="line"><span class="comment">--左外连接：两个表在连接过程中除返回满足连接条件的行为外,还返回左表中不满足条件的行为，这种连接称为左外连接</span></span><br><span class="line">写法:where e.deptno=d.deptno(+)</span><br><span class="line"></span><br><span class="line"><span class="comment">--右外连接: 当where e.deptno=d.deptno不成立的时候，等号右边的表任然被包含在最后的结果中</span></span><br><span class="line">写法:where e.deptno(+)=d.deptno</span><br><span class="line"></span><br><span class="line">范例：</span><br><span class="line"><span class="comment">--查询员工表中所有员工</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp;</span><br><span class="line">     EMPNO ENAME      JOB              MGR HIREDATE            SAL       COMM     DEPTNO</span><br><span class="line"><span class="comment">---------- ---------- --------- ---------- ------------ ---------- ---------- ----------</span></span><br><span class="line">      7369 SMITH      CLERK           7902 17-DEC-80           800                    20</span><br><span class="line">      7499 ALLEN      SALESMAN        7698 20-FEB-81          1600        300         30</span><br><span class="line">      7521 WARD       SALESMAN        7698 22-FEB-81          1250        500         30</span><br><span class="line">      7566 JONES      MANAGER         7839 02-APR-81          2975                    20</span><br><span class="line">      7654 MARTIN     SALESMAN        7698 28-SEP-81          1250       1400         30</span><br><span class="line">      7698 BLAKE      MANAGER         7839 01-MAY-81          2850                    30</span><br><span class="line">      7782 CLARK      MANAGER         7839 09-JUN-81          2450                    10</span><br><span class="line">      7788 SCOTT      ANALYST         7566 19-APR-87          3000                    20</span><br><span class="line">      7839 KING       PRESIDENT            17-NOV-81          5000                    10</span><br><span class="line">      7844 TURNER     SALESMAN        7698 08-SEP-81          1500          0         30</span><br><span class="line">      7876 ADAMS      CLERK           7788 23-MAY-87          1100                    20</span><br><span class="line">      7900 JAMES      CLERK           7698 03-DEC-81           950                    30</span><br><span class="line">      7902 FORD       ANALYST         7566 03-DEC-81          3000                    20</span><br><span class="line">      7934 MILLER     CLERK           7782 23-JAN-82          1300                    10</span><br><span class="line"></span><br><span class="line"><span class="comment">--查询部门表中所有数据</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> dept;</span><br><span class="line">    DEPTNO DNAME          LOC</span><br><span class="line"><span class="comment">---------- -------------- -------------</span></span><br><span class="line">        10 ACCOUNTING     NEW YORK</span><br><span class="line">        20 RESEARCH       DALLAS</span><br><span class="line">        30 SALES          CHICAGO</span><br><span class="line">        40 OPERATIONS     BOSTON</span><br><span class="line"></span><br><span class="line"><span class="comment">--查询每个部门的员工数量（员工表中没有一个员工属于40号部门，使用外连接，将40号部门保留下来）</span></span><br><span class="line"><span class="keyword">select</span> d.deptno 部门号,d.dname 部门名称,<span class="keyword">count</span>(e.empno) 人数<span class="keyword">from</span> emp e,dept d <span class="keyword">where</span> e.deptno(+)=d.deptno</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> d.deptno,d.dname;</span><br><span class="line">    部门号 部门名称             人数                                            </span><br><span class="line"><span class="comment">---------- -------------- ----------                                            </span></span><br><span class="line">        10 ACCOUNTING              3                                            </span><br><span class="line">        40 OPERATIONS              0                                            </span><br><span class="line">        20 RESEARCH                5                                            </span><br><span class="line">        30 SALES                   6  </span><br><span class="line">    </span><br><span class="line"><span class="comment">--自连接: 通过表的别名，将同一张表视为多张表</span></span><br><span class="line"><span class="keyword">select</span> e.ename 员工姓名,b.ename 老板姓名 <span class="keyword">from</span> emp e,emp b <span class="keyword">where</span> e.mgr=b.empno;</span><br><span class="line"></span><br><span class="line">员工姓名   老板姓名    </span><br><span class="line"><span class="comment">---------- ----------</span></span><br><span class="line">FORD       JONES      </span><br><span class="line">SCOTT      JONES </span><br><span class="line">JAMES      BLAKE        </span><br><span class="line">TURNER     BLAKE         </span><br><span class="line">MARTIN     BLAKE            </span><br><span class="line">WARD       BLAKE      </span><br><span class="line"></span><br><span class="line">自连接不适合操作大表</span><br><span class="line"></span><br><span class="line"><span class="comment">--层次查询</span></span><br><span class="line">层次查询使用树的遍历，走遍含树形结构的数据集合，来获取树的层次关系报表的方法</span><br><span class="line">树形结构的父子关系，你可以控制：</span><br><span class="line">（1）遍历树的方向，是自上而下，还是自下而上</span><br><span class="line">（2）确定层次的开始点(root)的位置</span><br><span class="line"></span><br><span class="line">层次查询语句正是从这两个方面来确定的,<span class="keyword">start</span> <span class="keyword">with</span>确定开始点,<span class="keyword">connect</span> <span class="keyword">by</span>确定遍历的方向</span><br><span class="line"></span><br><span class="line">语法：</span><br><span class="line"><span class="keyword">select</span> [<span class="keyword">level</span>],<span class="keyword">column</span>,expr... <span class="keyword">from</span> <span class="keyword">table</span></span><br><span class="line">[<span class="keyword">where</span> condition(s)]</span><br><span class="line">[<span class="keyword">start</span> <span class="keyword">with</span> condition(s)]</span><br><span class="line">[connetct <span class="keyword">by</span> <span class="keyword">prior</span> condition(s)]</span><br><span class="line"></span><br><span class="line">注释：</span><br><span class="line"><span class="number">1.</span><span class="keyword">level</span>是伪列，表示等级</span><br><span class="line"><span class="number">2.</span><span class="keyword">from</span>后面只能是一个表或视图，对于<span class="keyword">from</span>是视图的，那么这个<span class="keyword">view</span>不能包含<span class="keyword">join</span></span><br><span class="line"><span class="number">3.</span><span class="keyword">Where</span>条件限制了查询返回的行，但是不影响层次关系，属于将节点截断，但是这个被截断的节点的下层<span class="keyword">child</span>不受影响</span><br><span class="line"><span class="number">4.</span><span class="keyword">prior</span>是个形容词，可放在任何地方</span><br><span class="line"><span class="number">5.</span>彻底剪枝条件应放在<span class="keyword">connect</span> <span class="keyword">by</span>；单点剪掉条件应放在<span class="keyword">where</span>子句。但是，<span class="keyword">connect</span> <span class="keyword">by</span>的优先级要高于<span class="keyword">where</span>，也就是<span class="keyword">sql</span>引擎先执行<span class="keyword">connect</span> <span class="keyword">by</span></span><br><span class="line"><span class="number">6.</span>在<span class="keyword">start</span> <span class="keyword">with</span>中表达式可以有子查询，但是<span class="keyword">connect</span> <span class="keyword">by</span>中不能有子查询</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">level</span>,empno,ename,mgr <span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">connect</span> <span class="keyword">by</span> <span class="keyword">prior</span> empno=mgr <span class="keyword">start</span> <span class="keyword">with</span> mgr <span class="keyword">is</span> <span class="literal">null</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br><span class="line">    LEVEL      EMPNO ENAME             MGR                      </span><br><span class="line"><span class="comment">---------- ---------- ---------- ----------            </span></span><br><span class="line">         1       7839 KING                  </span><br><span class="line">         2       7566 JONES            7839     </span><br><span class="line">         2       7698 BLAKE            7839               </span><br><span class="line">         2       7782 CLARK            7839        </span><br><span class="line">         3       7902 FORD             7566 </span><br><span class="line">         3       7521 WARD             7698 </span><br><span class="line">         3       7900 JAMES            7698  </span><br><span class="line">         3       7934 MILLER           7782     </span><br><span class="line">         3       7499 ALLEN            7698  </span><br><span class="line">         3       7788 SCOTT            7566</span><br></pre></td></tr></table></figure><div class="post-announce">感谢您的阅读，本文由 <a href="http://yoursite.com">Maker</a> 版权所有。如若转载，请注明出处：Maker（<a href="http://yoursite.com/2018/03/14/Oracle基本命令04/">http://yoursite.com/2018/03/14/Oracle基本命令04/</a>）</div><div class="post__prevs"><div class="post__prev"><a href="/2018/03/14/Oracle基本命令03/" title="Oracle多行函数"><i class="iconfont icon-prev"></i>Oracle多行函数</a></div><div class="post__prev post__prev--right"><a href="/2018/03/15/javaBase/" title="Java集合类01 总体框架">Java集合类01 总体框架<i class="iconfont icon-next"></i></a></div></div></div></article></div><aside class="page__sidebar"><form id="page-search-from" class="page__search-from" action="/search/"><label class="search-form__item"><input class="input" type="text" name="search" placeholder="Search..."> <i class="iconfont icon-search"></i></label></form><div class="sidebar__block"><h3 class="block__title">FOR YOU</h3><p class="block__text">能同途偶遇在这星球上,燃亮飘渺人生,我多么够运#很高心遇到你#</p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="300" height="400" src="//music.163.com/outchain/player?type=0&id=2136099488&auto=0&height=430&data-index=2"></iframe></div><div class="sidebar__block"><h3 class="block__title">文章标签</h3><ul class="block-list tag-list clearfix"><li class="tag-item"><a class="tag-link" href="/tags/JAVA集合类/">JAVA集合类</a></li><li class="tag-item"><a class="tag-link" href="/tags/Oracle/">Oracle</a></li><li class="tag-item"><a class="tag-link" href="/tags/SQL/">SQL</a></li><li class="tag-item"><a class="tag-link" href="/tags/中文乱码/">中文乱码</a></li><li class="tag-item"><a class="tag-link" href="/tags/工具/">工具</a></li><li class="tag-item"><a class="tag-link" href="/tags/数据库/">数据库</a></li></ul></div><div class="sidebar__block"><h3 class="block__title">文章分类</h3><ul class="block-list"><li class="block-list-item"><a class="block-list-link" href="/categories/Oracle/">Oracle</a><span class="block-list-count">5</span><ul class="block-list-child"><li class="block-list-item"><a class="block-list-link" href="/categories/Oracle/SQL/">SQL</a><span class="block-list-count">4</span></li></ul></li><li class="block-list-item"><a class="block-list-link" href="/categories/Markdown/">Markdown</a><span class="block-list-count">1</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/Java基础/">Java基础</a><span class="block-list-count">2</span><ul class="block-list-child"><li class="block-list-item"><a class="block-list-link" href="/categories/Java基础/集合类/">集合类</a><span class="block-list-count">2</span></li></ul></li></ul></div><div class="sidebar__block"><h3 class="block__title">最新文章</h3><ul class="block-list latest-post-list"><li class="latest-post-item"><a href="/2018/03/15/javaBase2/" title="Java集合类02 ArrayList"><div class="item__cover"><img src="/img/java.jpg" alt="Java集合类02 ArrayList"></div><div class="item__info"><h3 class="item__title">Java集合类02 ArrayList</h3><span class="item__text">2018-03-15</span></div></a></li><li class="latest-post-item"><a href="/2018/03/15/javaBase/" title="Java集合类01 总体框架"><div class="item__cover"><img src="/img/java.jpg" alt="Java集合类01 总体框架"></div><div class="item__info"><h3 class="item__title">Java集合类01 总体框架</h3><span class="item__text">2018-03-15</span></div></a></li><li class="latest-post-item"><a href="/2018/03/14/Oracle基本命令04/" title="Oracle多表查询"><div class="item__cover"><img src="/img/oracle.gif" alt="Oracle多表查询"></div><div class="item__info"><h3 class="item__title">Oracle多表查询</h3><span class="item__text">2018-03-14</span></div></a></li><li class="latest-post-item"><a href="/2018/03/14/Oracle基本命令03/" title="Oracle多行函数"><div class="item__cover"><img src="/img/oracle.gif" alt="Oracle多行函数"></div><div class="item__info"><h3 class="item__title">Oracle多行函数</h3><span class="item__text">2018-03-14</span></div></a></li></ul></div></aside></main><footer class="page__footer"><section class="footer__top"><div class="page__container footer__container"><div class="footer-top__item footer-top__item--2"><h3 class="item__title">关于</h3><div class="item__content"><p class="item__text">本站是基于 Hexo 搭建的静态资源博客，主要用于分享日常学习、生活及工作的一些心得总结，欢迎点击右下角订阅 rss。</p><ul class="footer__contact-info"><li class="contact-info__item"><i class="iconfont icon-address"></i> <span>Guangzhou, Guangdong Province, China</span></li><li class="contact-info__item"><i class="iconfont icon-email2"></i> <span>Bintao_Ma@163.com</span></li></ul></div></div><div class="footer-top__item footer__image"><img src="/img/qrcode.jpg" alt="logo" title="Maker"></div></div></section><section class="footer__bottom"><div class="page__container footer__container"><p class="footer__copyright">© <a href="https://github.com/Mrminfive/hexo-theme-skapp" target="_blank">Skapp</a> 2017 powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, made by <a href="https://github.com/Mrminfive" target="_blank">minfive</a>.</p><ul class="footer__social-network clearfix"><li class="social-network__item"><a href="https://github.com/Mabintao" target="_blank" title="github"><i class="iconfont icon-github"></i></a></li><li class="social-network__item"><a href="mailto:Bintao_Ma@163.com" target="_blank" title="email"><i class="iconfont icon-email"></i></a></li><li class="social-network__item"><a href="/atom.xml" target="_blank" title="rss"><i class="iconfont icon-rss"></i></a></li></ul></div></section></footer><div id="back-top" class="back-top back-top--hidden js-hidden"><i class="iconfont icon-top"></i></div></div><script src="/js/common.js"></script><script src="/js/page/post.js"></script><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>